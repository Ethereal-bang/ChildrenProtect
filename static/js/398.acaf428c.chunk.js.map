{"version":3,"file":"static/js/398.acaf428c.chunk.js","mappings":"gMAGaA,EAAU,SAACC,GACpB,IAAMC,EAAO,IAAIC,SAEjB,OADAD,EAAKE,OAAO,UAAWH,EAAO,IACvBI,EAAAA,EAAAA,KAAa,cAAeH,EACtC,EAUYI,EAAY,SAACC,GACtB,IAAML,EAAO,IAAIC,SAEjB,OADAD,EAAKE,OAAO,KAAMG,IACXF,EAAAA,EAAAA,GAAQ,gBAAiB,CAACH,KAAAA,GACpC,C,yKCLKM,EAAe,CACjB,EAAG,iCACH,EAAG,uCACH,EAAG,uCACH,EAAG,6CACH,EAAG,+DACH,EAAG,yDACH,EAAG,mDACH,EAAG,yDACH,EAAG,0DAqBP,SAASC,EAAWC,GAElB,OADeA,EAATC,KAECC,KAAI,SAACC,GACR,OACE,iBAAKC,UAAU,OAAqBC,MAAO,CAAEC,QAAS,OAAQC,MAAO,QAASC,eAAgB,iBAA9F,WACE,gBAAKJ,UAAU,OAAf,SAAuBD,EAAKM,QAC5B,gBAAKL,UAAU,MAAf,SAAsBD,EAAKO,OAC3B,gBAAKN,UAAU,KAAf,SAAqBD,EAAKQ,OAHDR,EAAKQ,GAMnC,GAEJ,CAWD,SAASC,EAAMZ,GAEb,IAAMa,EAAmBb,EAAnBa,QAASC,EAAUd,EAAVc,OAoBf,OAnBAC,EAAAA,EAAAA,YAAU,WACR,IAAIb,EAAM,IAAIc,OAAOC,IAAIH,EAAOI,SAChChB,EAAIiB,cAAc,IAAIH,OAAOI,MAAM,SAAU,QAAU,IACvDlB,EAAImB,wBAEJ,IAAIC,EAAa,IAAIN,OAAOO,K,y+EAAa,IAAIP,OAAOQ,KAAK,GAAI,KAE7DX,EAAQY,SAAQ,SAACC,GACf,IACIC,EADEC,EAAwBF,EAAxBE,UAAWC,EAAaH,EAAbG,SAGjBF,EAAU,IAAIX,OAAOc,OAAO,IAAId,OAAOI,OAAOS,GAAWD,GAAW,CAClEG,KAAKT,IAEPpB,EAAI8B,WAAWL,EAChB,GAEF,GAAE,CAACd,EAASC,KAGX,gBAAKmB,GAAG,QAAQ5B,MAAO,CAAE,MAAS,OAAQ,OAAU,OAAQ,UAAa,SAAU,UAAa,+BAAgC6B,OAAQ,OAG3I,CAEc,SAASC,IACpB,OAAgCC,EAAAA,EAAAA,YAAhC,eAAOC,EAAP,KAAiBC,EAAjB,KACA,GAA8BF,EAAAA,EAAAA,YAA9B,eAAOG,EAAP,KAAgBC,EAAhB,KAIEP,GAFWQ,EAAAA,EAAAA,MACMC,MACET,GAEnBU,GAAQC,EAAAA,EAAAA,QAAO,MACfC,GAAOD,EAAAA,EAAAA,QAAO,MAedE,GAAWC,EAAAA,EAAAA,MAgBf,OAVAhC,EAAAA,EAAAA,YAAU,WACR,IAAKkB,EAAI,OAAOe,EAAA,QAAa,2CAC7BpD,EAAAA,EAAAA,IAAUqC,GAAIgB,MAAK,SAAAC,GACf,MAAgCA,EAAI1D,KAAKA,KAAlC2D,EAAP,EAAOA,SAAUC,EAAjB,EAAiBA,YACjBd,EAAYa,GACZX,EAAWY,EACd,IAAE,SAAAC,GACC,OAAOL,EAAA,SAAcK,EAAIC,SAAS9D,KAAKwD,QAC1C,GACF,GAAE,CAACf,KAEF,+BACE,iBAAK7B,UAAU,eAAf,WACE,iBAAKA,UAAU,QAAf,eAAwB,iBAAMA,UAAU,OAAOmD,QAlBxC,WACXT,GAAU,EACX,EAgB6B,sCAAxB,KAA4E,2BAAO,SAACU,EAAA,EAAD,MAAnF,oBACA,iBAAKpD,UAAU,UAAf,WACE,iBAAKA,UAAU,QAAf,WACE,gBAAKA,UAAU,QAAf,uCAGA,iBAAKA,UAAU,UAAf,WACE,gBAAKA,UAAU,QAAf,UACE,iBAAKA,UAAU,OAAf,4CACO,0BAAQN,GAAqB,OAARuC,QAAQ,IAARA,OAAA,EAAAA,EAAUoB,YAAa,QACjD,iBAAKrD,UAAU,QAAf,4CACO,iCAAOiC,QAAP,IAAOA,OAAP,EAAOA,EAAUqB,oBAI5B,gBAAKtD,UAAU,QAAf,UACE,iBAAKA,UAAU,OAAf,4CACO,iBAAMC,MAAO,CAAE,eAAkB,aAAjC,gBACFgC,QADE,IACFA,OADE,EACFA,EAAUsB,oBAIjB,iBAAKvD,UAAU,QAAf,4CACO,2BAAM,cAAQwD,KAAK,UAAb,UAAwB,iBAAMvD,MAAO,CAAEwD,MAAO,QAAtB,8CAErC,iBAAKzD,UAAU,QAAf,4CACO,2BAAM,2BAAM,cAAQwD,KAAK,UAAb,UAAuB,iBAAMvD,MAAO,CAAEwD,MAAO,QAAtB,gDAE1C,iBAAKzD,UAAU,QAAf,yDACU,wBAGV,gBAAKA,UAAU,mBAAmB0D,IAAKnB,EAAvC,UACE,SAAC/B,EAAD,CAAOC,QAjEG,CACtB,CACEe,UAAW,WACXC,SAAU,YA8D4Bf,OAAQ6B,aAI1C,iBAAKvC,UAAU,UAAf,WACE,gBAAKA,UAAU,QAAf,uCAGA,iBAAKA,UAAU,UAAf,WACE,iBAAKA,UAAU,OAAf,WACI,iBAAMA,UAAU,QAAhB,6CAAoC,iCAAOmC,QAAP,IAAOA,OAAP,EAAOA,EAASwB,aAAaC,cAErE,iBAAK5D,UAAU,OAAf,WACE,iBAAMA,UAAU,QAAhB,qEAAwC,0BAAOL,EAAW,CAAEE,MAAa,OAAPsC,QAAO,IAAPA,OAAA,EAAAA,EAAS0B,YAAa,WAE1F,iBAAK7D,UAAU,OAAf,WACE,iBAAMA,UAAU,QAAhB,+DAAuC,0BAAOL,EAAW,CAAEE,MAAa,OAAPsC,QAAO,IAAPA,OAAA,EAAAA,EAAS2B,YAAa,WAEzF,iBAAK9D,UAAU,OAAf,WACE,iBAAMA,UAAU,QAAhB,yDAAsC,wBAExC,gBAAKA,UAAU,mBAAmB0D,IAAKjB,EAAvC,UACE,SAACjC,EAAD,CAAOC,QAjFE,CACrB,CACEe,UAAW,WACXC,SAAU,YA8E4Bf,OAAQ+B,mBAQnD,C","sources":["api/eventApi.ts","views/Detail/Detail.tsx"],"sourcesContent":["import {myAxios} from \"./myAxios\";\r\n\r\n// 获取全部事件\r\nexport const getList = (page: number) => {\r\n    const data = new FormData();\r\n    data.append(\"current\", page + '');\r\n    return myAxios.post(\"/event/list\", data)\r\n}\r\n\r\n// 电话检索事件\r\nexport const searchEvent = (keyword: string) => {\r\n    const data = new FormData();\r\n    data.append(\"keyword\", keyword);\r\n    return myAxios.post(\"/event/search\", data);\r\n}\r\n\r\n// 事件详情\r\nexport const getDetail = (eventId: string) => {\r\n    const data = new FormData();\r\n    data.append(\"id\", eventId);\r\n    return myAxios(\"/event/detail\", {data});\r\n}","import { useLocation, useNavigate } from 'react-router-dom'\r\nimport { RightOutlined } from '@ant-design/icons'\r\nimport {Button, message} from 'antd'\r\nimport './Detail.css'\r\nimport {useRef, useEffect, useState} from 'react'\r\nimport marker from '../../assets/icons/marker.png'\r\nimport {getDetail} from \"../../api/eventApi\";\r\n\r\ninterface PList {\r\n  Name: string,\r\n  Sex: string,\r\n  Id: string\r\n}\r\ninterface listProps {\r\n  List: PList[]\r\n}\r\nconst eventTypeMap = {\r\n    0: \"非强制事件\",\r\n    1: \"未成年人乞讨\",\r\n    2: \"未成年人犯罪\",\r\n    3: \"未成年人被遗弃\",\r\n    4: \"未成年人隐私部位损伤\",\r\n    5: \"未成年人伤残、死亡\",\r\n    6: \"未成年人来源不明\",\r\n    7: \"未成年人怀孕、流产\",\r\n    8: \"其他非强制报告事件\",\r\n}\r\ntype EventTypeIndex = '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8';\r\ninterface PostInfo {\r\n    EventType: EventTypeIndex,  // 事件类型\r\n    PostTime: string,   // 上报时间\r\n    Description: string,    // 事件描述\r\n    VideoUrl: string,\r\n    ImageUrl: string,\r\n    Lat: number,\r\n    Lon: number,\r\n}\r\ninterface ResInfo {\r\n    BasicResolve: {\r\n        Process: string,    // 事件经过\r\n        EventType: EventTypeIndex,\r\n        Organization: string,\r\n    }\r\n    ChildList: Array<PList>,  // 涉及到未成年人\r\n    AdultList: Array<PList>,  // 涉及到成年人\r\n}\r\nfunction personList(props: listProps) {\r\n  let { List } = props\r\n  return (\r\n    List.map((list) => {\r\n      return (\r\n        <div className=\"list\" key={list.Id} style={{ display: 'flex', width: '300px', justifyContent: \"space-between\" }}>\r\n          <div className=\"name\">{list.Name}</div>\r\n          <div className=\"sex\">{list.Sex}</div>\r\n          <div className=\"id\">{list.Id}</div>\r\n        </div>\r\n      )\r\n    })\r\n  )\r\n}\r\n\r\ninterface map {\r\n  longitude: string | number   //经度\r\n  latitude: string | number // 纬度\r\n  status?:string\r\n}\r\ninterface mapProps {\r\n  mapList: map[],\r\n  mapRef:any\r\n}\r\nfunction MyMap(props: mapProps) {\r\n\r\n  let { mapList ,mapRef} = props\r\n  useEffect(() => {\r\n    let map = new BMapGL.Map(mapRef.current);\r\n    map.centerAndZoom(new BMapGL.Point(106.5907, 29.7320), 16);\r\n    map.enableScrollWheelZoom();\r\n\r\n    let markerIcon = new BMapGL.Icon(marker, new BMapGL.Size(52, 26));\r\n\r\n    mapList.forEach((marker) => {\r\n      let { longitude, latitude } = marker\r\n      let Pointer: any\r\n      // 创建点标记\r\n      Pointer = new BMapGL.Marker(new BMapGL.Point(+latitude, +longitude),{\r\n        icon:markerIcon\r\n      })\r\n      map.addOverlay(Pointer)\r\n    })\r\n\r\n  }, [mapList, mapRef])\r\n\r\n  return (\r\n    <div id='mymap' style={{ \"width\": \"100%\", \"height\": \"100%\", \"textAlign\": \"center\", \"boxShadow\": \"0px 0px 10px rgba(0,0,0,0.2)\", zIndex: \"99\" }}>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default function Detail() {\r\n    const [postInfo, setPostInfo] = useState<PostInfo>();   // 上传信息\r\n    const [resInfo, setResInfo] = useState<ResInfo>();   // 处置信息\r\n\r\n  let location = useLocation()\r\n  let state = location.state as any\r\n  let id: string = state.id\r\n\r\n  let map1 =  useRef(null)\r\n  let map2 = useRef(null)\r\n\r\n  let mapListOld: map[] = [\r\n    {\r\n      longitude: \"106.5907\",\r\n      latitude: \"29.7320\"\r\n    }\r\n  ]\r\n  let mapListNew:map[] = [\r\n    {\r\n      longitude: \"106.5908\",\r\n      latitude: \"29.7330\"\r\n    }\r\n  ]\r\n\r\n  let navigate = useNavigate()\r\n  let goBack = () => {\r\n    navigate(-1)\r\n  }\r\n\r\n  // 请求事件详情\r\n  useEffect(() => {\r\n    if (!id) return message.warn(\"事件ID获取失败\");\r\n    getDetail(id).then(res => {\r\n        const {PostInfo, ResolveInfo} = res.data.data;\r\n        setPostInfo(PostInfo);\r\n        setResInfo(ResolveInfo);\r\n    }, err => {\r\n        return message.error(err.response.data.message);\r\n    })\r\n  }, [id])\r\n  return (\r\n    <>\r\n      <div className='detail-outer'>\r\n        <div className=\"title\"> <span className='back' onClick={goBack}>事件管理</span> <span ><RightOutlined /></span> 详情</div>\r\n        <div className=\"details\">\r\n          <div className=\"upMes\">\r\n            <div className=\"title\">\r\n              上传信息\r\n            </div>\r\n            <div className=\"content\">\r\n              <div className=\"line1\">\r\n                <div className=\"left\">\r\n                  事件类型：<span >{eventTypeMap[postInfo?.EventType || '0']}</span>\r\n                  <div className=\"right\">\r\n                    上报时间：<span>{postInfo?.PostTime}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"line2\">\r\n                <div className=\"left\">\r\n                  事件描述：<span style={{ \"textDecoration\": \"underline\" }}>\r\n                    {postInfo?.Description}\r\n                </span>\r\n                </div>\r\n              </div>\r\n              <div className=\"line3\">\r\n                现场视频：<span><Button type='primary' ><span style={{ color: '#fff' }}>查看视频</span></Button></span>\r\n              </div>\r\n              <div className=\"line4\">\r\n                现场照片：<span><span><Button type='primary'><span style={{ color: '#fff' }}>查看照片</span></Button></span></span>\r\n              </div>\r\n              <div className=\"line5\">\r\n                事件发生位置： <span />\r\n              </div>\r\n\r\n              <div className=\"mapSite1 mapSite\" ref={map1}>\r\n                <MyMap mapList={mapListOld} mapRef={map1}/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"dealMes\">\r\n            <div className=\"title\">\r\n              处置信息\r\n            </div>\r\n            <div className=\"content\">\r\n              <div className=\"line\">\r\n                  <span className=\"title\">事件经过：</span><span>{resInfo?.BasicResolve.Process}</span>\r\n              </div>\r\n              <div className=\"line\">\r\n                <span className=\"title\">设计到的未成年人：</span><span>{personList({ List: resInfo?.ChildList || [] })}</span>\r\n              </div>\r\n              <div className=\"line\">\r\n                <span className=\"title\">涉及到的成年人：</span><span>{personList({ List: resInfo?.AdultList || [] })}</span>\r\n              </div>\r\n              <div className=\"line\">\r\n                <span className=\"title\">修订后的位置：</span><span />\r\n              </div>\r\n              <div className=\"mapSite2 mapSite\" ref={map2}>\r\n                <MyMap mapList={mapListNew} mapRef={map2}/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n"],"names":["getList","page","data","FormData","append","myAxios","getDetail","eventId","eventTypeMap","personList","props","List","map","list","className","style","display","width","justifyContent","Name","Sex","Id","MyMap","mapList","mapRef","useEffect","BMapGL","Map","current","centerAndZoom","Point","enableScrollWheelZoom","markerIcon","Icon","Size","forEach","marker","Pointer","longitude","latitude","Marker","icon","addOverlay","id","zIndex","Detail","useState","postInfo","setPostInfo","resInfo","setResInfo","useLocation","state","map1","useRef","map2","navigate","useNavigate","message","then","res","PostInfo","ResolveInfo","err","response","onClick","RightOutlined","EventType","PostTime","Description","type","color","ref","BasicResolve","Process","ChildList","AdultList"],"sourceRoot":""}